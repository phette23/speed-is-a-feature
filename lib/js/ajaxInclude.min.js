/*! Ajax-Include - v0.1.0 - 2012-08-22
* http://filamentgroup.com/lab/ajax_includes_modular_content/
* Copyright (c) 2012 @scottjehl, Filament Group, Inc.; Licensed MIT */
(function(a,b){a.fn.ajaxInclude=function(b){function h(b){var c=b.data("url");g.proxy&&a.inArray(c,d)===-1?(d.push(c),e=e.add(b)):i(b.data("url"),b)}function i(b,c){a.get(b,function(a){c.trigger("ajaxIncludeResponse",[a])})}function j(){d.length&&(i(g.proxy+d.join(","),e),e=a(),d=[])}function k(a,b){function e(){h(a),j(),d.removeListener(e)}var d=c.matchMedia(b);d.addListener&&d.addListener(e)}var c=window,d=[],e=a(),f="data-ajax-bound",g={proxy:null};return typeof b=="string"?g.proxy=b:g=a.extend(g,b),this.not("["+f+"]").each(function(b){var d=a(this),e=d.attr("data-media"),i=["append","replace","before","after"],j,l;for(var m=i.length,n=0;n<m;n++)d.is("[data-"+i[n]+"]")&&(j=i[n],l=d.attr("data-"+j));j==="replace"&&(j+="With"),d.data("method",j).data("url",l).attr(f,!0).bind("ajaxIncludeResponse",function(a,b){var c=b;if(g.proxy){var e=c.match(new RegExp("<entry url=[\"']?"+d.data("url")+"[\"']?>(?:(?!</entry>)(.|\n))*","gmi"));e&&(c=e[0])}var f=d.triggerHandler("ajaxIncludeFilter",[c]);f&&(c=f),d[d.data("method")](c).trigger("ajaxInclude",[c])}),!e||c.matchMedia&&c.matchMedia(e).matches?h(d):e&&c.matchMedia&&k(d,e)}),j(),this}})(jQuery);